---
title: "`flippant` -- An `R` package for the automated  analysis of dithionite 
  scramblase assays"
author: "Johannes Graumann ^†,^*, Birgit Ploier ^‡^, Richard J. Cotton ^†^,
  Mike A. Goren ^‡^ and Anant K. Menon ^‡^"
date: "September 16, 2015"
output: 
#  word_document
  pdf_document:
    fig_caption: yes
bibliography: flippant.bib
csl: bioinformatics.csl
---

†
:    \
    Weill Cornell Medical College in Qatar, P.O.Box 24144, Doha, State of Qatar

‡
:   Department of Biochemistry, Weill Cornell Medical College, New York, NY 
    10065, USA

\*
:   To whom correspondence should be addressed: jog2030@qatar-med.cornell.edu

```{r, echo = FALSE}
suppressMessages(
  library(magrittr))
suppressMessages(
  library(stringi))
flippant_dependencies <- packageDescription("flippant",fields=c("Depends","Imports")) %>%
  unlist(use.names = FALSE) %>%
  stri_split(regex = ",", omit_empty = TRUE) %>%
  unlist(use.names = FALSE) %>%
  stri_replace_all(replacement = "", regex = "\\s*\\(.*\\)\\s*", omit_empty = TRUE) %>%
  stri_replace_all(replacement = "", regex = "\\s*", omit_empty = TRUE) %>%
  tail(n=length(.) - 1) %>%
  sort() %>%
  ( function(x){
    paste0(
      c(
        "`",
        paste0(head(x, n = length(x) - 1), collapse = "`, `"),
        "` and `",
        tail(x, n = 1),
        "`"),
      collapse = "")} )

```

#Abstract

##Summary

##Availability and Implementation

##Contact
jog2030@qatar-med.cornell.edu

##Supplementary Information

# Introduction
Scramblases are proteins mediating the mass-action driven equilibration of 
lipids between the leaflets of lipid bilayers that constitute biological membranes
[@waechter_flippases_2013]. Independent of energy equivalents such as ATP they 
facilitate this ``flipping'' by providing to polar lipid head groups a mechanism
of transition through the hydrophobic environment of membranes, thus reducing 
the massive energetic cost that process would carry otherwise 
[@kornberg_inside-outside_1971]. While the underlying molecular mechanisms in 
many cases remain enigmatic [for a discussion including exceptions see @ernst_phospholipid_2015], and molecules supporting flipping processes as 
central as the equilibration of the ubiquitous phosphoglycerolipids across the 
membrane of the endoplasmic reticulum, where they are synthesized in the 
cytoplasmic monolayer, have yet to be identified **(I was looking for a recent 
citation that clearly spelled that out - in vain. Do you have a proposal?)**, 
there has been much recent progress in scramblase identification and 
characterization. Molecules shown to have scramblase activity include 
opsin/rhodopsin [@menon_opsin_2011;@goren_constitutive_2014], TMEM16 
[@malvezzi_ca2-dependent_2013], $\beta$ 2-adrenergic and adenosine A2A 
receptors [both @goren_constitutive_2014]. **Would be good to include/replace some 
with non-in-house identifications/characterizations. What else is out there?**

To interrogate factors of this functional class, we have developed a biochemical 
assay suited to characterize scramblase activity in purified proteins and protein 
extracts [@chang_chemical_2004] based on the reconstitution of scramblases or 
candidate proteins into synthetic liposomes with a lipid
composition that includes nitrobenzoxadiazole (NBD) labeled fluorescent lipids.
Upon exposure of these liposomes to membrane-impermeable reducing agents such as 
dithionite, fluorophores in the external leaflet are quenched and fluorescence in scramblase-free liposomes accordingly quickly drops to approximately 50% of the 
initial value. However, for proteoliposomes reconstituted with proteins 
conferring a scramblase activity, fluorescence disappears entirely, as
fast scramblase-mediated equilibration between outer (exposed) and inner
(protected) leaflet of the bilayer renders all fluorescent lipids
accessible to reduction. By titration of the protein amount reconstituted into
the liposome membranes it is thus possible to characterize scramblases and probe
their activity. Beyond the identification of scramblase activities in crude 
membrane preparations [@chang_chemical_2004;@rajasekharan_flip-flop_2011] and 
functional validation of candidate scramblases [@menon_opsin_2011;@malvezzi_ca2-dependent_2013;@goren_constitutive_2014], the 
assay has also been used to characterize the stoichiometry of scramblase 
homo-multimers reconstituting into the proteoliposomes 
[@ploier_perturbed_submitted] and probe the ATP-dependence of flippases, 
molecules that under energy-consumption flip lipids against a concentration 
gradient between bilayer leaflets [@soupene_atp8a1_2008].
**Are you aware of further use? More adoption would fortify the need for the 
package ...**

Starting with the identification of baseline and post-reduction fluorescence 
from fluorometer-generated spectra, via the calculation of the underlying 
statistics and through publication-grade representation of the results, data 
analysis in the context of this assay has until now involved an extensive series
of manual steps, at most supported by spreadsheet calculation facilities
[see the supplementary material of @menon_opsin_2011 for extensive step-wise discussion].
Based on the `R` free software environment for statistical computing and 
graphics [@r_core_team_r:_2015] and prominently drawing on the power and 
elegance of the `ggplot2` plotting system [@wickham_ggplot2_2009], we here 
provide `flippant`, a package that comprehensively, fast and reproducibly covers
all data analysis and graphing needs from raw fluorescence spectra produced by 
scramblase assays. A simple parametrizing spreadsheet is the sole required user 
input.

#Installation
`flippant` has been integrated into the `bioconductor` collection of tools for 
biomedical data analysis [@huber_orchestrating_2015] and is thus installable and
loadable as follows from within a functioning `R` environment:
```{r eval = FALSE}
source("http://bioconductor.org/biocLite.R")
biocLite(pkgs = "flippant")
library(flippant)
```
The package depends on the following, automatically satisfied extensions to `R`
base functionality: `r flippant_dependencies`

#Input Data and Data Processing
To analyse raw data stemming from dithionite scramblase assays, `flippant` 
requires for each data point information as the path to the 
fluorometer-generated spectrum, the amount of protein used to reconstitute 
proteoliposomes, the volume used in the assay before and after addition of 
dithionite (to calculate a volume correction factor), the amount of lips 
present (to calculate a proteine to phospholipid ratio or PPR) etc. The 
following function generates a spreadsheet program-compatible tab-delimited 
#Main Features
##Template Generation for Data Input
The following function generates a spreadsheet program-compatible tab-delimited 
`ASCII` template including column names, commentary, expected data type and the 
default used when ommited, supporting the user in providing the data needed.
```{r, code=formatR::usage('scramblaseAssayInputTemplate'), eval=FALSE}
```
The application agnostic tab-delimited format must be maintained for the 
completed table, which is subjected to extensive input checks when read by 
`flippant`.

Spectral input data is read by `flippant` using the information provided in the
input template raw spectra produced by QuantaMaster fluorometer instruments 
(Photon Technology International,Inc., Edison, New Jersey) running software 
versions FelixGX v4.1 and Felix32 v1.20, respectively, as well as simple generic
tab-delimited spectrum representing file format with time (s) and fluorescence 
intensity containing columns are currently supported. File type determination is
handled algorythmically.

##Graphic Representation of Spectral Traces
```{r, code = formatR::usage('scramblaseAssayTraces'), eval = FALSE}
```

##Producing Protein To Phospholipid (PPR) Plots
```{r, code = formatR::usage('scramblaseAssayPlot'), eval = FALSE}
```

##Non-graphical Output of Analysis Results
```{r, code = formatR::usage('scramblaseAssayStats'), eval = FALSE}
```

#Case Study

#Conclusion

#Funding
J.G., R.J.C. and the Proteomics Core at WCMC-Q were supported by ``Biomedical 
Research Program'' funds at Weill Cornell Medical College in Qatar, a program 
funded by Qatar Foundation. B.P. was supported by a grant from Qatar National 
Research Fund’s National Priority Research Program (5-669-1-112) to J.G. and
A.K.M.

#Acknowledgements

#References
